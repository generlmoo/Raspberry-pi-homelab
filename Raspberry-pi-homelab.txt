Raspberry Pi Homelab (Pi-hole + OMV/NAS + Jellyfin + Filebrowser)
=================================================================


                   Internet
                      │
               (Cloudflare Tunnel)
                      │
                Example.com
      ┌───────────────┼─────────────────┐
  files.Example.com   │      watch.Example.com
  (FileBrowser)       │      (Jellyfin)
                      │
            nas.Example.com
            (OpenMediaVault admin)
                      |
                      │
                 Raspberry Pi 5 (Pi OS Lite on 256 GB MicroSD)
     ┌────────────────┴────────────────┐
     │                                 │
2 TB NVMe (OS + media)          8 TB USB SSD (bulk media)

Goals
-----
- Keep the base OS minimal and stable (Raspberry Pi OS Lite).
- Use NVMe + external storage for data.
- Make services play nicely together (no port conflicts).
- Secure remote access (Cloudflare Tunnel for apps, Tailscale for break-glass admin).


Hardware
--------
- Raspberry pi with the M.2 hat for NVMe storage 
- OPTIONAL: Metal M.2 custom case for pi protection
- OS disk: microSD card (Raspberry Pi OS Lite)
- Data disk: 2 TB NVMe on an M.2 HAT (metal case + cooling)
- Data disk: 8 TB external drive

Important notes
---------------
- Raspberry Pi OS Lite must be installed to the microSD (do not put the OS image on the NVMe).
- Filebrowser should keep its config/database on the OS disk (microSD). Only point it at mounted data directories.
- Partitioning/formatting can be dangerous if you pick the wrong device; double-check with `lsblk` before running any disk commands.


Software / Services
-------------------
- OS: Raspberry Pi OS Lite (command-line based, minimal overhead)
- Pi-hole: DNS + ad blocking (optionally using Cloudflare upstream DNS)
- OpenMediaVault (OMV): manage disks/shares/services
- Filebrowser: web UI for browsing files
- Jellyfin: media server
- Cloudflare: domain + tunnels (no open inbound ports)
- Tailscale: secure remote access (SSH/admin if something breaks)


How these work together
-----------------------
Storage
- NVMe (2TB) + external (8TB) are mounted to directories (example: `/mnt/nvme2tb`, `/mnt/usb8tb`).
- OMV shares point at those mount points.
- Jellyfin libraries point at those mount points.
- Filebrowser is configured to browse those mount points, but stores its own config on the OS disk.

Networking / ports (avoid conflicts)
- Pi-hole uses DNS ports (53/tcp+udp) and has a web UI.
- OMV also has a web UI.
- Jellyfin typically uses `8096`.
- Filebrowser typically uses `8080`.

If two services want the same port (commonly port 80), change one of them so each has its own port.


Cloudflare (domain + tunnels)
-----------------------------
- Buy a domain and add it to Cloudflare.
- Create Cloudflare Tunnels so services can be accessed without port-forwarding.
- Use different subdomains per service (examples):
  - `jellyfin.<your-domain>` -> `http://localhost:8096`
  - `files.<your-domain>` -> `http://localhost:8080`
- Strongly consider protecting any admin UIs with Cloudflare Access (especially Pi-hole / OMV).


Tailscale (break-glass access)
------------------------------
- Use Tailscale for secure remote SSH/admin access from anywhere.
- This is the "if something goes wrong" path when the tunnel/app path isn't working.


Commands / Step-by-step
-----------------------
See `docs/SETUP.md` for:
- Mounting the 2TB NVMe and the 8TB drive (with example commands)
- Installing OMV, Pi-hole, Filebrowser, and Jellyfin
- Cloudflare Tunnel and Tailscale setup notes

